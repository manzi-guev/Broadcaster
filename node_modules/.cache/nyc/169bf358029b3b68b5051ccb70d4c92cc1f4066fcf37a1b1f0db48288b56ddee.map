{"version":3,"sources":["redflagController.js"],"names":["redflagController","req","res","body","title","comment","location","images","videos","createdOn","format","createdBy","header","type","status","newRedflag","con","query","redflags","insertRedflag","rowCount","json","message","data","rows","viewredflags","findredflags","error","id","parseInt","params","viewspecific","findspecific","deleteredflag","updatelocation","updatecomment"],"mappings":"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","file":"redflagController.js","sourceRoot":"C:/Users/CharisUAS/Desktop/Broadcaster/server/v2/controllers","sourcesContent":["/* eslint-disable consistent-return */\r\n/* eslint-disable node/no-unsupported-features/es-syntax */\r\nimport moment from 'moment';\r\nimport taketoken from '../helpers/token.verifier';\r\nimport con from '../db/connection';\r\nimport redflags from '../models/redflags';\r\n\r\nclass redflagController {\r\n  static async create(req, res) {\r\n    const { title, comment, location, images, videos } = req.body;\r\n    const createdOn = moment().format('MMMM Do YYYY, h:mm:ss a');\r\n    const createdBy = taketoken(req.header('token'));\r\n    const type = 'Redflag';\r\n    const status = 'pending...';\r\n    const newRedflag = await con.query(redflags.insertRedflag, [\r\n      createdOn,\r\n      createdBy,\r\n      title,\r\n      type,\r\n      comment,\r\n      location,\r\n      status,\r\n      images,\r\n      videos\r\n    ]);\r\n    /* istanbul ignore else */\r\n    if (newRedflag.rowCount === 1) {\r\n      return res.status(201).json({\r\n        status: 201,\r\n        message: 'Redflag successfully created',\r\n        data: newRedflag.rows[0]\r\n      });\r\n    }\r\n  }\r\n\r\n  static async viewredflags(req, res) {\r\n    const viewredflags = await con.query(redflags.findredflags);\r\n    /* istanbul ignore else */\r\n    if (viewredflags.rowCount >= 1) {\r\n      return res.status(200).json({\r\n        status: 200,\r\n        message: 'Success. List of all red-flags',\r\n        data: viewredflags.rows\r\n      });\r\n    }\r\n    return res.status(404).json({\r\n      status: 404,\r\n      error: 'Redflags not found'\r\n    });\r\n  }\r\n\r\n  static async viewSpecificflag(req, res) {\r\n    const id = parseInt(req.params.id, 10);\r\n    const viewspecific = await con.query(redflags.findspecific, [id]);\r\n    /* istanbul ignore else */\r\n    if (viewspecific.rowCount === 1) {\r\n      return res.status(200).json({\r\n        status: 200,\r\n        data: viewspecific.rows\r\n      });\r\n    }\r\n    return res.status(404).json({\r\n      status: 404,\r\n      error: 'Redflag not found'\r\n    });\r\n  }\r\n\r\n  static async delete(req, res) {\r\n    const id = parseInt(req.params.id, 10);\r\n    const viewspecific = await con.query(redflags.deleteredflag, [id]);\r\n    /* istanbul ignore else */\r\n    if (viewspecific.rowCount === 1) {\r\n      return res.status(200).json({\r\n        status: 200,\r\n        message: 'Redflag successfully deleted'\r\n      });\r\n    }\r\n  }\r\n\r\n  static async editLocation(req, res) {\r\n    const { location } = req.body;\r\n    const id = parseInt(req.params.id, 10);\r\n    const viewspecific = await con.query(redflags.updatelocation, [\r\n      id,\r\n      location\r\n    ]);\r\n    /* istanbul ignore else */\r\n    if (viewspecific.rowCount === 1) {\r\n      return res.status(200).json({\r\n        status: 200,\r\n        message: 'Updated red-flag location',\r\n        data: {\r\n          id: id,\r\n          location: location\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  static async editComment(req, res) {\r\n    const { comment } = req.body;\r\n    const id = parseInt(req.params.id, 10);\r\n    const viewspecific = await con.query(redflags.updatecomment, [id, comment]);\r\n    /* istanbul ignore else */\r\n    if (viewspecific.rowCount === 1) {\r\n      return res.status(200).json({\r\n        status: 200,\r\n        message: 'Updated red-flag comment',\r\n        data: {\r\n          id: id,\r\n          comment: comment\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\nexport default redflagController;\r\n"]}