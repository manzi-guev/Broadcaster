{"version":3,"sources":["userController.js"],"names":["userController","req","res","email","body","check","userModel","signup","status","json","token","message","data","id","users","length","firstname","lastname","phonenumber","username","error","password","findUser","find","u","bcrypt","compareSync"],"mappings":";;;;;;qjBAAA;;;AACA;;;;AACA;;AACA;;;;;;;;IAEMA,c;;;;;;;2BACUC,G,EAAKC,G,EAAK;AAAA,UACdC,KADc,GACJF,IAAIG,IADA,CACdD,KADc;;AAEtB,UAAME,QAAQC,iBAAUC,MAAV,CAAiBN,GAAjB,CAAd;AACA,UAAII,KAAJ,EAAW;AACT,eAAOH,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAQ,GADkB;AAE1BE,iBAAO,2BAAeP,KAAf,CAFmB;AAG1BQ,mBAAS,0BAHiB;AAI1BC,gBAAM;AACJC,gBAAIC,aAAMA,aAAMC,MAAN,GAAe,CAArB,EAAwBF,EADxB;AAEJG,uBAAWF,aAAMA,aAAMC,MAAN,GAAe,CAArB,EAAwBC,SAF/B;AAGJC,sBAAUH,aAAMA,aAAMC,MAAN,GAAe,CAArB,EAAwBE,QAH9B;AAIJd,mBAAOW,aAAMA,aAAMC,MAAN,GAAe,CAArB,EAAwBZ,KAJ3B;AAKJe,yBAAaJ,aAAMA,aAAMC,MAAN,GAAe,CAArB,EAAwBG,WALjC;AAMJC,sBAAUL,aAAMA,aAAMC,MAAN,GAAe,CAArB,EAAwBI;AAN9B;AAJoB,SAArB,CAAP;AAaD;AACD,aAAOjB,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,gBAAQ,GADkB;AAE1BY,eAAO;AAFmB,OAArB,CAAP;AAID;;;2BAEanB,G,EAAKC,G,EAAK;AAAA,sBACMD,IAAIG,IADV;AAAA,UACdD,KADc,aACdA,KADc;AAAA,UACPkB,QADO,aACPA,QADO;;AAEtB,UAAMC,WAAWR,aAAMS,IAAN,CAAW;AAAA,eAAKC,EAAErB,KAAF,KAAYA,KAAjB;AAAA,OAAX,CAAjB;AACA,UAAI,CAACmB,QAAL,EAAe;AACb,eAAOpB,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAQ,GADkB;AAE1BY,iBAAO;AAFmB,SAArB,CAAP;AAID;AACD,UAAIK,mBAAOC,WAAP,CAAmBL,QAAnB,EAA6BC,SAASD,QAAtC,CAAJ,EAAqD;AACnD,eAAOnB,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAQ,GADkB;AAE1BE,iBAAO,2BAAeP,KAAf,CAFmB;AAG1BQ,mBAAS;AAHiB,SAArB,CAAP;AAKD;AACD,aAAOT,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,gBAAQ,GADkB;AAE1BY,eAAO;AAFmB,OAArB,CAAP;AAID;;;;;;kBAEYpB,c","file":"userController.js","sourceRoot":"C:/Users/CharisUAS/Desktop/Broadcaster/server/v1/controllers","sourcesContent":["/* eslint-disable node/no-unsupported-features/es-syntax */\r\nimport bcrypt from 'bcryptjs';\r\nimport { users, userModel } from '../models/users';\r\nimport tokengenerator from '../helpers/helperToken';\r\n\r\nclass userController {\r\n  static signup(req, res) {\r\n    const { email } = req.body;\r\n    const check = userModel.signup(req);\r\n    if (check) {\r\n      return res.status(201).json({\r\n        status: 201,\r\n        token: tokengenerator(email),\r\n        message: 'User succesfully created',\r\n        data: {\r\n          id: users[users.length - 1].id,\r\n          firstname: users[users.length - 1].firstname,\r\n          lastname: users[users.length - 1].lastname,\r\n          email: users[users.length - 1].email,\r\n          phonenumber: users[users.length - 1].phonenumber,\r\n          username: users[users.length - 1].username\r\n        }\r\n      });\r\n    }\r\n    return res.status(409).json({\r\n      status: 409,\r\n      error: 'User already exists'\r\n    });\r\n  }\r\n\r\n  static signin(req, res) {\r\n    const { email, password } = req.body;\r\n    const findUser = users.find(u => u.email === email);\r\n    if (!findUser) {\r\n      return res.status(404).json({\r\n        status: 404,\r\n        error: 'User with provided email doesnt exist'\r\n      });\r\n    }\r\n    if (bcrypt.compareSync(password, findUser.password)) {\r\n      return res.status(200).json({\r\n        status: 200,\r\n        token: tokengenerator(email),\r\n        message: 'User successfully logged in'\r\n      });\r\n    }\r\n    return res.status(401).json({\r\n      status: 401,\r\n      error: 'Password is incorrect'\r\n    });\r\n  }\r\n}\r\nexport default userController;\r\n"]}