{"version":3,"sources":["owner.js"],"names":["access","req","res","next","email","header","id","parseInt","params","foundredflag","redflag","findRedFlag","status","json","error","owner","redflags","find","flag","createdBy"],"mappings":";;;;;;AAEA;;;;AACA;;;;AAHA;AACA;AAIA,IAAMA,SAAS,eAATA,MAAS,CAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,EAA0B;AACvC,MAAMC,QAAQ,2BAASH,IAAII,MAAJ,CAAW,OAAX,CAAT,CAAd;AACA,MAAMC,KAAKC,SAASN,IAAIO,MAAJ,CAAWF,EAApB,EAAwB,EAAxB,CAAX;AACA,MAAMG,eAAeC,kBAAQC,WAAR,CAAoBL,EAApB,CAArB;AACA,MAAI,CAACG,YAAL,EAAmB;AACjB,WAAOP,IAAIU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,cAAQ,GADkB;AAE1BE,aAAO;AAFmB,KAArB,CAAP;AAID;AACD,MAAMC,QAAQC,mBAASC,IAAT,CAAc;AAAA,WAAQC,KAAKC,SAAL,KAAmBf,KAA3B;AAAA,GAAd,CAAd;AACA,MAAI,CAACW,KAAL,EAAY;AACV,WAAOb,IAAIU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,cAAQ,GADkB;AAE1BE,aAAO;AAFmB,KAArB,CAAP;AAID;AACDX;AACD,CAlBD;;kBAoBeH,M","file":"owner.js","sourceRoot":"C:/Users/CharisUAS/Desktop/Broadcaster/server/middlewares","sourcesContent":["/* eslint-disable consistent-return */\r\n/* eslint-disable node/no-unsupported-features/es-syntax */\r\nimport verifier from '../helpers/verifyToken';\r\nimport { redflags, redflag } from '../models/redflags';\r\n\r\nconst access = async (req, res, next) => {\r\n  const email = verifier(req.header('token'));\r\n  const id = parseInt(req.params.id, 10);\r\n  const foundredflag = redflag.findRedFlag(id);\r\n  if (!foundredflag) {\r\n    return res.status(404).json({\r\n      status: 404,\r\n      error: 'Redflag not found'\r\n    });\r\n  }\r\n  const owner = redflags.find(flag => flag.createdBy === email);\r\n  if (!owner) {\r\n    return res.status(403).json({\r\n      status: 403,\r\n      error: 'You are not the owner'\r\n    });\r\n  }\r\n  next();\r\n};\r\n\r\nexport default access;\r\n"]}