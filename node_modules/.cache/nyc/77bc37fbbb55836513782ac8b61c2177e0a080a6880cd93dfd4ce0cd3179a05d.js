'use strict';var cov_ijkkgki8u=function(){var path="C:\\Users\\CharisUAS\\Desktop\\Broadcaster\\server\\v2\\middleware\\owner.js";var hash="f7b54fae003f19790df11f8ff178a2a1fec3f6eb";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\CharisUAS\\Desktop\\Broadcaster\\server\\v2\\middleware\\owner.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:18},end:{line:7,column:45}},"2":{start:{line:9,column:19},end:{line:9,column:54}},"3":{start:{line:11,column:19},end:{line:11,column:52}},"4":{start:{line:13,column:20},end:{line:13,column:56}},"5":{start:{line:15,column:16},end:{line:15,column:45}},"6":{start:{line:17,column:17},end:{line:17,column:50}},"7":{start:{line:19,column:39},end:{line:19,column:93}},"8":{start:{line:21,column:13},end:{line:39,column:1}},"9":{start:{line:22,column:14},end:{line:22,column:61}},"10":{start:{line:23,column:11},end:{line:23,column:38}},"11":{start:{line:24,column:21},end:{line:24,column:92}},"12":{start:{line:25,column:2},end:{line:30,column:3}},"13":{start:{line:26,column:4},end:{line:29,column:7}},"14":{start:{line:31,column:14},end:{line:31,column:85}},"15":{start:{line:32,column:2},end:{line:37,column:3}},"16":{start:{line:33,column:4},end:{line:36,column:7}},"17":{start:{line:38,column:2},end:{line:38,column:16}},"18":{start:{line:40,column:0},end:{line:40,column:25}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:19,column:9},end:{line:19,column:31}},loc:{start:{line:19,column:37},end:{line:19,column:95}},line:19},"1":{name:"access",decl:{start:{line:21,column:28},end:{line:21,column:34}},loc:{start:{line:21,column:51},end:{line:39,column:1}},line:21}},branchMap:{"0":{loc:{start:{line:19,column:46},end:{line:19,column:92}},type:"cond-expr",locations:[{start:{line:19,column:70},end:{line:19,column:73}},{start:{line:19,column:76},end:{line:19,column:92}}],line:19},"1":{loc:{start:{line:19,column:46},end:{line:19,column:67}},type:"binary-expr",locations:[{start:{line:19,column:46},end:{line:19,column:49}},{start:{line:19,column:53},end:{line:19,column:67}}],line:19},"2":{loc:{start:{line:25,column:2},end:{line:30,column:3}},type:"if",locations:[{start:{line:25,column:2},end:{line:30,column:3}},{start:{line:25,column:2},end:{line:30,column:3}}],line:25},"3":{loc:{start:{line:32,column:2},end:{line:37,column:3}},type:"if",locations:[{start:{line:32,column:2},end:{line:37,column:3}},{start:{line:32,column:2},end:{line:37,column:3}}],line:32}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"f7b54fae003f19790df11f8ff178a2a1fec3f6eb"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();cov_ijkkgki8u.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _connection=(cov_ijkkgki8u.s[1]++,require('../db/connection'));var _connection2=(cov_ijkkgki8u.s[2]++,_interopRequireDefault(_connection));var _verifyToken=(cov_ijkkgki8u.s[3]++,require('../helpers/verifyToken'));var _verifyToken2=(cov_ijkkgki8u.s[4]++,_interopRequireDefault(_verifyToken));var _redflags=(cov_ijkkgki8u.s[5]++,require('../models/redflags'));var _redflags2=(cov_ijkkgki8u.s[6]++,_interopRequireDefault(_redflags));function _interopRequireDefault(obj){cov_ijkkgki8u.f[0]++;cov_ijkkgki8u.s[7]++;return(cov_ijkkgki8u.b[1][0]++,obj)&&(cov_ijkkgki8u.b[1][1]++,obj.__esModule)?(cov_ijkkgki8u.b[0][0]++,obj):(cov_ijkkgki8u.b[0][1]++,{default:obj});}cov_ijkkgki8u.s[8]++;var access=async function access(req,res,next){cov_ijkkgki8u.f[1]++;var email=(cov_ijkkgki8u.s[9]++,(0,_verifyToken2.default)(req.header('token')));var id=(cov_ijkkgki8u.s[10]++,parseInt(req.params.id,10));var foundredflag=(cov_ijkkgki8u.s[11]++,await _connection2.default.query(_redflags2.default.findspecific,[id]));cov_ijkkgki8u.s[12]++;if(foundredflag.rowCount!==1){cov_ijkkgki8u.b[2][0]++;cov_ijkkgki8u.s[13]++;return res.status(404).json({status:404,error:'Redflag not found'});}else{cov_ijkkgki8u.b[2][1]++;}var owner=(cov_ijkkgki8u.s[14]++,await _connection2.default.query(_redflags2.default.findowner,[email]));cov_ijkkgki8u.s[15]++;if(!owner.rowCount){cov_ijkkgki8u.b[3][0]++;cov_ijkkgki8u.s[16]++;return res.status(403).json({status:403,error:'You are not the owner'});}else{cov_ijkkgki8u.b[3][1]++;}cov_ijkkgki8u.s[17]++;return next();};/* eslint-disable node/no-unsupported-features/es-syntax */cov_ijkkgki8u.s[18]++;exports.default=access;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm93bmVyLmpzIl0sIm5hbWVzIjpbImFjY2VzcyIsInJlcSIsInJlcyIsIm5leHQiLCJlbWFpbCIsImhlYWRlciIsImlkIiwicGFyc2VJbnQiLCJwYXJhbXMiLCJmb3VuZHJlZGZsYWciLCJjb24iLCJxdWVyeSIsInJlZGZsYWdzIiwiZmluZHNwZWNpZmljIiwicm93Q291bnQiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJvd25lciIsImZpbmRvd25lciJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7QUFFQSxJQUFNQSxTQUFTLGVBQVRBLE1BQVMsQ0FBT0MsR0FBUCxFQUFZQyxHQUFaLEVBQWlCQyxJQUFqQixFQUEwQjtBQUN2QyxNQUFNQyxRQUFRLDJCQUFTSCxJQUFJSSxNQUFKLENBQVcsT0FBWCxDQUFULENBQWQ7QUFDQSxNQUFNQyxLQUFLQyxTQUFTTixJQUFJTyxNQUFKLENBQVdGLEVBQXBCLEVBQXdCLEVBQXhCLENBQVg7QUFDQSxNQUFNRyxlQUFlLE1BQU1DLHFCQUFJQyxLQUFKLENBQVVDLG1CQUFTQyxZQUFuQixFQUFpQyxDQUFDUCxFQUFELENBQWpDLENBQTNCO0FBQ0EsTUFBSUcsYUFBYUssUUFBYixLQUEwQixDQUE5QixFQUFpQztBQUMvQixXQUFPWixJQUFJYSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDMUJELGNBQVEsR0FEa0I7QUFFMUJFLGFBQU87QUFGbUIsS0FBckIsQ0FBUDtBQUlEO0FBQ0QsTUFBTUMsUUFBUSxNQUFNUixxQkFBSUMsS0FBSixDQUFVQyxtQkFBU08sU0FBbkIsRUFBOEIsQ0FBQ2YsS0FBRCxDQUE5QixDQUFwQjtBQUNBLE1BQUksQ0FBQ2MsTUFBTUosUUFBWCxFQUFxQjtBQUNuQixXQUFPWixJQUFJYSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDMUJELGNBQVEsR0FEa0I7QUFFMUJFLGFBQU87QUFGbUIsS0FBckIsQ0FBUDtBQUlEO0FBQ0QsU0FBT2QsTUFBUDtBQUNELENBbEJELEMsQ0FMQTtrQkF5QmVILE0iLCJmaWxlIjoib3duZXIuanMiLCJzb3VyY2VSb290IjoiQzovVXNlcnMvQ2hhcmlzVUFTL0Rlc2t0b3AvQnJvYWRjYXN0ZXIvc2VydmVyL3YyL21pZGRsZXdhcmUiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBub2RlL25vLXVuc3VwcG9ydGVkLWZlYXR1cmVzL2VzLXN5bnRheCAqL1xyXG5pbXBvcnQgY29uIGZyb20gJy4uL2RiL2Nvbm5lY3Rpb24nO1xyXG5pbXBvcnQgdmVyaWZpZXIgZnJvbSAnLi4vaGVscGVycy92ZXJpZnlUb2tlbic7XHJcbmltcG9ydCByZWRmbGFncyBmcm9tICcuLi9tb2RlbHMvcmVkZmxhZ3MnO1xyXG5cclxuY29uc3QgYWNjZXNzID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgY29uc3QgZW1haWwgPSB2ZXJpZmllcihyZXEuaGVhZGVyKCd0b2tlbicpKTtcclxuICBjb25zdCBpZCA9IHBhcnNlSW50KHJlcS5wYXJhbXMuaWQsIDEwKTtcclxuICBjb25zdCBmb3VuZHJlZGZsYWcgPSBhd2FpdCBjb24ucXVlcnkocmVkZmxhZ3MuZmluZHNwZWNpZmljLCBbaWRdKTtcclxuICBpZiAoZm91bmRyZWRmbGFnLnJvd0NvdW50ICE9PSAxKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICBzdGF0dXM6IDQwNCxcclxuICAgICAgZXJyb3I6ICdSZWRmbGFnIG5vdCBmb3VuZCdcclxuICAgIH0pO1xyXG4gIH1cclxuICBjb25zdCBvd25lciA9IGF3YWl0IGNvbi5xdWVyeShyZWRmbGFncy5maW5kb3duZXIsIFtlbWFpbF0pO1xyXG4gIGlmICghb3duZXIucm93Q291bnQpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7XHJcbiAgICAgIHN0YXR1czogNDAzLFxyXG4gICAgICBlcnJvcjogJ1lvdSBhcmUgbm90IHRoZSBvd25lcidcclxuICAgIH0pO1xyXG4gIH1cclxuICByZXR1cm4gbmV4dCgpO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYWNjZXNzO1xyXG4iXX0=